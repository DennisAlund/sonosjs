/**
 * almond 0.2.7 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 *  Sugar Library v1.4.1
 *
 *  Freely distributable and licensed under the MIT-style license.
 *  Copyright (c) 2013 Andrew Plummer
 *  http://sugarjs.com/
 *
 * ---------------------------- */

/** ---------------------------------------------------------------------------
 *  SonosJS
 *  Copyright 2013 Dennis Alund
 *  http://github.com/oddbit/sonosjs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * ------------------------------------------------------------------------- */

!function(t,n){"function"==typeof define&&define.amd?define(n):t.SonosJS=n()}(this,function(){var t,n,e;return function(r){function i(t,n){return E.call(t,n)}function o(t,n){var e,r,i,o,u,a,s,c,f,l,h=n&&n.split("/"),d=y.map,m=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=h.concat(t.split("/")),c=0;c<t.length;c+=1)if(l=t[c],"."===l)t.splice(c,1),c-=1;else if(".."===l){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||m)&&d){for(e=t.split("/"),c=e.length;c>0;c-=1){if(r=e.slice(0,c).join("/"),h)for(f=h.length;f>0;f-=1)if(i=d[h.slice(0,f).join("/")],i&&(i=i[r])){o=i,u=c;break}if(o)break;!a&&m&&m[r]&&(a=m[r],s=c)}!o&&a&&(o=a,u=s),o&&(e.splice(0,u,o),t=e.join("/"))}return t}function u(t,n){return function(){return d.apply(r,b.call(arguments,0).concat([t,n]))}}function a(t){return function(n){return o(n,t)}}function s(t){return function(n){g[t]=n}}function c(t){if(i(v,t)){var n=v[t];delete v[t],w[t]=!0,h.apply(r,n)}if(!i(g,t)&&!i(w,t))throw new Error("No "+t);return g[t]}function f(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function l(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,d,m,p,g={},v={},y={},w={},E=Object.prototype.hasOwnProperty,b=[].slice;m=function(t,n){var e,r=f(t),i=r[0];return t=r[1],i&&(i=o(i,n),e=c(i)),i?t=e&&e.normalize?e.normalize(t,a(n)):o(t,n):(t=o(t,n),r=f(t),i=r[0],t=r[1],i&&(e=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},p={require:function(t){return u(t)},exports:function(t){var n=g[t];return"undefined"!=typeof n?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:l(t)}}},h=function(t,n,e,o){var a,f,l,h,d,y,E=[],b=typeof e;if(o=o||t,"undefined"===b||"function"===b){for(n=!n.length&&e.length?["require","exports","module"]:n,d=0;d<n.length;d+=1)if(h=m(n[d],o),f=h.f,"require"===f)E[d]=p.require(t);else if("exports"===f)E[d]=p.exports(t),y=!0;else if("module"===f)a=E[d]=p.module(t);else if(i(g,f)||i(v,f)||i(w,f))E[d]=c(f);else{if(!h.p)throw new Error(t+" missing "+f);h.p.load(h.n,u(o,!0),s(f),{}),E[d]=g[f]}l=e?e.apply(g[t],E):void 0,t&&(a&&a.exports!==r&&a.exports!==g[t]?g[t]=a.exports:l===r&&y||(g[t]=l))}else t&&(g[t]=e)},t=n=d=function(t,n,e,i,o){return"string"==typeof t?p[t]?p[t](n):c(m(t,n).f):(t.splice||(y=t,n.splice?(t=n,n=e,e=null):t=r),n=n||function(){},"function"==typeof e&&(e=i,i=o),i?h(r,t,n,e):setTimeout(function(){h(r,t,n,e)},4),d)},d.config=function(t){return y=t,y.deps&&d(y.deps,y.callback),d},t._defined=g,e=function(t,n,e){n.splice||(e=n,n=[]),i(g,t)||i(v,t)||(v[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("almond",function(){}),function(){function t(t){return function(){return t}}function n(t){var n="Array"===t&&oe.isArray||function(n,e){return(e||he.call(n))==="[object "+t+"]"};return ve[t]=n}function e(t,n){function e(e){return p(e)?he.call(e)==="[object "+n+"]":typeof e===t}return ve[n]=e}function r(t){t.SugarMethods||(s(t,"SugarMethods",{}),i(t,!1,!0,{extend:function(n,e,r){i(t,!1!==r,e,n)},sugarRestore:function(){return u(this,t,arguments,function(t,n,e){s(t,n,e.method)})},sugarRevert:function(){return u(this,t,arguments,function(t,n,e){e.existed?s(t,n,e.original):delete t[n]})}}))}function i(t,n,e,i){var o=n?t.prototype:t;r(t),y(i,function(r,i){var u=o[r],c=m(o,r);Ae(e)&&u&&(i=a(u,i,e)),!1===e&&u||s(o,r,i),t.SugarMethods[r]={method:i,existed:c,original:u,instance:n}})}function o(t,n,e,r,o){var u={};r=ke(r)?r.split(","):r,r.forEach(function(t,n){o(u,t,n)}),i(t,n,e,u)}function u(t,n,e,r){var i=0===e.length,o=c(e),u=!1;return y(n.SugarMethods,function(n,e){(i||-1!==o.indexOf(n))&&(u=!0,r(e.instance?t.prototype:t,n,e))}),u}function a(t,n,e){return function(){return e.apply(this,arguments)?n.apply(this,arguments):t.apply(this,arguments)}}function s(t,n,e){me?ie.defineProperty(t,n,{value:e,configurable:!0,enumerable:!1,writable:!0}):t[n]=e}function c(t,n,e){var r=[];e=e||0;var i;for(i=t.length;i>e;e++)r.push(t[e]),n&&n.call(t,t[e],e);return r}function f(t,n,e){var r=t[e||0];Te(r)&&(t=r,e=0),c(t,n,e)}function l(t){if(!t||!t.call)throw new TypeError("Callback is not callable")}function h(t){return void 0!==t}function d(t){return void 0===t}function m(t,n){return!!t&&de.call(t,n)}function p(t){return!!t&&("object"==typeof t||pe&&Oe(t))}function g(t){var n=typeof t;return null==t||"string"===n||"number"===n||"boolean"===n}function v(t,n){n=n||he.call(t);try{if(t&&t.constructor&&!m(t,"constructor")&&!m(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!!t&&"[object Object]"===n&&"hasOwnProperty"in t}function y(t,n){for(var e in t)if(m(t,e)&&!1===n.call(t,e,t[e],t))break}function w(t,n){for(var e=0;t>e;e++)n(e)}function E(t,n){return y(n,function(e){t[e]=n[e]}),t}function b(t){if(g(t)&&(t=ie(t)),ge&&ke(t))for(var n,e=t,r=0;n=e.charAt(r);)e[r++]=n;return t}function k(t){E(this,b(t))}function T(t,n,e){var r=Ie(10,Ne(n||0));return e=e||Re,0>n&&(r=1/r),e(t*r)/r}function S(){return"	\n\f\r   ᠎             \u2028\u2029　﻿"}function O(t,n){var e="";for(t=t.toString();n>0;)1&n&&(e+=t),(n>>=1)&&(t+=t);return e}function A(t,n){var e,r;return e=t.replace(Ce,function(t){return t=Ge[t],t===je&&(r=!0),t}),r?parseFloat(e):parseInt(e,n||10)}function C(t,n,e,r){return r=Ne(t).toString(r||10),r=O("0",n-r.replace(/\.\d+/,"").length)+r,(e||0>t)&&(r=(0>t?"-":"+")+r),r}function N(t){if(t>=11&&13>=t)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function I(t,n){function e(t,e){(t||-1<n.indexOf(e))&&(r+=e)}var r="";return n=n||"",e(t.multiline,"m"),e(t.ignoreCase,"i"),e(t.global,"g"),e(t.u,"y"),r}function D(t){return ke(t)||(t=se(t)),t.replace(/([\\/\'*+?|()\[\]{}.^$])/g,"\\$1")}function x(t,n){return t["get"+(t._utc?"UTC":"")+n]()}function R(t,n,e){return t["set"+(t._utc&&"ISOWeek"!=n?"UTC":"")+n](e)}function U(t,n){var e,r,i,o,u,a,s,c=typeof t;if("string"===c)return t;if(i=he.call(t),e=v(t,i),r=Te(t,i),null!=t&&e||r){if(n||(n=[]),1<n.length)for(a=n.length;a--;)if(n[a]===t)return"CYC";for(n.push(t),e=t.valueOf()+se(t.constructor),o=r?t:ie.keys(t).sort(),a=0,s=o.length;s>a;a++)u=r?a:o[a],e+=u+U(t[u],n);n.pop()}else e=-1/0===1/t?"-0":se(t&&t.valueOf?t.valueOf():t);return c+i+e}function _(t,n){return t===n?0!==t||1/t===1/n:F(t)&&F(n)?U(t)===U(n):!1}function F(t){var n=he.call(t);return ye.test(n)||v(t,n)}function M(t,n,e){var r,i=t.length,o=n.length,u=!1!==n[o-1];return o>(u?1:2)?(r=[],c(n,function(n){return Ee(n)?!1:(r.push(L(t,i,n,u,e)),void 0)}),r):L(t,i,n[0],u,e)}function L(t,n,e,r,i){return r&&(e%=n,0>e&&(e=n+e)),i?t.charAt(e):t[e]}function P(t,n){o(n,!0,!1,t,function(t,n){t[n+("equal"===n?"s":"")]=function(){return ie[n].apply(null,[this].concat(c(arguments)))}})}function j(t,n,e,r){var i=t.length,o=-1==r,u=o?i-1:0;for(e=isNaN(e)?u:parseInt(e>>0),0>e&&(e=i+e),(!o&&0>e||o&&e>=i)&&(e=u);o&&e>=0||!o&&i>e;){if(t[e]===n)return e;e+=r}return-1}function V(t,n,e,r){var i=t.length,o=0,u=h(e);if(l(n),0==i&&!u)throw new TypeError("Reduce called on empty array with no initial value");for(u||(e=t[r?i-1:o],o++);i>o;)u=r?i-o-1:o,u in t&&(e=n(e,t[u],u,t)),o++;return e}function G(t){if(0===t.length)throw new TypeError("First argument must be defined")}function W(t){return t=ue(t),function(n){return t.test(n)}}function B(t){var n=t.getTime();return function(t){return!(!t||!t.getTime)&&t.getTime()===n}}function z(t){return function(n,e,r){return n===t||t.call(this,n,e,r)}}function q(t){return function(n,e,r){return n===t||t.call(r,e,n,r)}}function H(t,n){var e={};return function(r,i,o){var u;if(!p(r))return!1;for(u in t)if(e[u]=e[u]||Y(t[u],n),!1===e[u].call(o,r[u],i,o))return!1;return!0}}function $(t){return function(n){return n===t||_(n,t)}}function Y(t,n){if(!g(t)){if(Oe(t))return W(t);if(Se(t))return B(t);if(Ae(t))return n?q(t):z(t);if(v(t))return H(t,n)}return $(t)}function Z(t,n,e,r){return n?n.apply?n.apply(e,r||[]):Ae(t[n])?t[n].call(t):t[n]:t}function Q(t,n,e,r){var i=+t.length;for(0>e&&(e=t.length+e),e=isNaN(e)?0:e,!0===r&&(i+=e);i>e;){if(r=e%t.length,!(r in t)){J(t,n,e);break}if(!1===n.call(t,t[r],r,t))break;e++}}function J(t,n,e){var r,i=[];for(r in t)r in t&&r>>>0==r&&4294967295!=r&&r>=e&&i.push(parseInt(r));i.sort().each(function(e){return n.call(t,t[e],e,t)})}function X(t,n,e,r,i,o){var u,a,s;return 0<t.length&&(s=Y(n),Q(t,function(n,e){return s.call(o,n,e,t)?(u=n,a=e,!1):void 0},e,r)),i?a:u}function K(t,n){var e,r=[],i={};return Q(t,function(o,u){e=n?Z(o,n,t,[o,u,t]):o,on(i,e)||r.push(o)}),r}function tn(t,n,e){var r=[],i={};return n.each(function(t){on(i,t)}),t.each(function(t){var n=U(t),o=!F(t);if(rn(i,n,t,o)!==e){var u=0;if(o)for(n=i[n];u<n.length;)n[u]===t?n.splice(u,1):u+=1;else delete i[n];r.push(t)}}),r}function nn(t,n,e){n=n||1/0,e=e||0;var r=[];return Q(t,function(t){Te(t)&&n>e?r=r.concat(nn(t,n,e+1)):r.push(t)}),r}function en(t){var n=[];return c(t,function(t){n=n.concat(t)}),n}function rn(t,n,e,r){var i=n in t;return r&&(t[n]||(t[n]=[]),i=-1!==t[n].indexOf(e)),i}function on(t,n){var e=U(n),r=!F(n),i=rn(t,e,n,r);return r?t[e].push(n):t[e]=n,i}function un(t,n,e,r){var i,o,u,a=[],s="max"===e,c="min"===e,f=oe.isArray(t);for(i in t)if(t.hasOwnProperty(i)){if(e=t[i],u=Z(e,n,t,f?[e,parseInt(i),t]:[]),d(u))throw new TypeError("Cannot compare with undefined");u===o?a.push(e):(d(o)||s&&u>o||c&&o>u)&&(a=[e],o=u)}return f||(a=nn(a,1)),r?a:a[0]}function an(t,n){var e,r,i,o,u=0,a=0;e=oe[qe],r=oe[He];var s=oe[$e],c=oe[ze],f=oe[Ye];t=sn(t,e,r),n=sn(n,e,r);do e=t.charAt(u),i=s[e]||e,e=n.charAt(u),o=s[e]||e,e=i?c.indexOf(i):null,r=o?c.indexOf(o):null,-1===e||-1===r?(e=t.charCodeAt(u)||null,r=n.charCodeAt(u)||null,f&&(e>=Fe&&Me>=e||e>=Le&&Pe>=e)&&(r>=Fe&&Me>=r||r>=Le&&Pe>=r)&&(e=A(t.slice(u)),r=A(n.slice(u)))):(i=i!==t.charAt(u),o=o!==n.charAt(u),i!==o&&0===a&&(a=i-o)),u+=1;while(null!=e&&null!=r&&e===r);return e===r?a:e-r}function sn(t,n,e){return ke(t)||(t=se(t)),e&&(t=t.toLowerCase()),n&&(t=t.replace(n,"")),t}function cn(t,n){o(ie,!1,!0,t,function(t,e){t[e]=function(t,r,i){var o,u=ie.keys(b(t));return n||(o=Y(r,!0)),i=oe.prototype[e].call(u,function(e){var i=t[e];return n?Z(i,r,t,[e,i,t]):o(i,e,t)},i),Te(i)&&(i=i.reduce(function(n,e){return n[e]=t[e],n},{})),i}}),P(t,k)}function fn(t){E(this,t),this.g=ar.concat()}function ln(t,n,e){var r,i,o=n[0],u=n[1],a=n[2];return n=t[e]||t.relative,Ae(n)?n.call(t,o,u,a,e):(i=t.units[8*(t.plural&&o>1?1:0)+u]||t.units[u],t.capitalizeUnit&&(i=yn(i)),r=t.modifiers.filter(function(t){return"sign"==t.name&&t.value==(a>0?1:-1)})[0],n.replace(/\{(.*?)\}/g,function(t,n){switch(n){case"num":return o;case"unit":return i;case"sign":return r.src}}))}function hn(t,n){return n=n||t.code,"en"===n||"en-US"===n?!0:t.variant}function dn(t,n){return n.replace(ue(t.num,"g"),function(n){return mn(t,n)||""})}function mn(t,n){var e;return be(n)?n:n&&-1!==(e=t.numbers.indexOf(n))?(e+1)%10:1}function pn(t,n){var e;if(ke(t)||(t=""),e=lr[t]||lr[t.slice(0,2)],!1===n&&!e)throw new TypeError("Invalid locale.");return e||tr}function gn(t,n){function e(t){var n=a[t];ke(n)?a[t]=n.split(","):n||(a[t]=[])}function r(t,n){t=t.split("+").map(function(t){return t.replace(/(.+):(.+)$/,function(t,n,e){return e.split("|").map(function(t){return n+t}).join("|")})}).join("|"),t.split("|").forEach(n)}function i(t,n,e){var i=[];a[t].forEach(function(t,o){n&&(t+="+"+t.slice(0,3)),r(t,function(t,n){i[n*e+o]=t.toLowerCase()})}),a[t]=i}function o(t,n,e){return t="\\d{"+t+","+n+"}",e&&(t+="|(?:"+wn(a.numbers)+")+"),t}function u(t,n){a[t]=a[t]||n}var a,s;return a=new fn(n),e("modifiers"),"months weekdays units numbers articles tokens timeMarker ampm timeSuffixes dateParse timeParse".split(" ").forEach(e),s=!a.monthSuffix,i("months",s,12),i("weekdays",s,7),i("units",!1,8),i("numbers",!1,10),u("code",t),u("date",o(1,2,a.digitDate)),u("year","'\\d{2}|"+o(4,4)),u("num",function(){var t=["-?\\d+"].concat(a.articles);return a.numbers&&(t=t.concat(a.numbers)),wn(t)}()),function(){var t=[];a.i={},a.modifiers.push({name:"day",src:"yesterday",value:-1}),a.modifiers.push({name:"day",src:"today",value:0}),a.modifiers.push({name:"day",src:"tomorrow",value:1}),a.modifiers.forEach(function(n){var e=n.name;r(n.src,function(r){var i=a[e];a.i[r]=n,t.push({name:e,src:r,value:n.value}),a[e]=i?i+"|"+r:r})}),a.day+="|"+wn(a.weekdays),a.modifiers=t}(),a.monthSuffix&&(a.month=o(1,2),a.months="1 2 3 4 5 6 7 8 9 10 11 12".split(" ").map(function(t){return t+a.monthSuffix})),a.full_month=o(1,2)+"|"+wn(a.months),0<a.timeSuffixes.length&&a.addFormat(Pn(a),!1,ir),a.addFormat("{day}",!0),a.addFormat("{month}"+(a.monthSuffix||"")),a.addFormat("{year}"+(a.yearSuffix||"")),a.timeParse.forEach(function(t){a.addFormat(t,!0)}),a.dateParse.forEach(function(t){a.addFormat(t)}),lr[t]=a}function vn(t,n,e,r){t.g.unshift({r:r,locale:t,q:ue("^"+n+"$","i"),to:e})}function yn(t){return t.slice(0,1).toUpperCase()+t.slice(1)}function wn(t){return t.filter(function(t){return!!t}).join("|")}function En(){var t=ae.SugarNewDate;return t?t():new ae}function bn(t,n){var e;return p(t[0])?t:be(t[0])&&!be(t[1])?[t[0]]:ke(t[0])&&n?[kn(t[0]),t[1]]:(e={},er.forEach(function(n,r){e[n.name]=t[r]}),[e])}function kn(t){var n,e={};return(t=t.match(/^(\d+)?\s?(\w+?)s?$/i))&&(d(n)&&(n=parseInt(t[1])||1),e[t[2].toLowerCase()]=n),e}function Tn(t,n,e){var r;for(d(e)&&(e=rr.length),n=n||0;e>n&&(r=rr[n],!1!==t(r.name,r,n));n++);}function Sn(t,n){var e,r,i={};return n.forEach(function(n,o){e=t[o+1],d(e)||""===e||("year"===n&&(i.t=e.replace(/'/,"")),r=parseFloat(e.replace(/'/,"").replace(/,/,".")),i[n]=isNaN(r)?e.toLowerCase():r)}),i}function On(t){return t=t.trim().replace(/^just (?=now)|\.+$/i,""),An(t)}function An(t){return t.replace(nr,function(t,n,e){var r,i,o=0,u=1;return n?t:(e.split("").reverse().forEach(function(t){t=ur[t];var n=t>9;n?(r&&(o+=u),u*=t/(i||1),i=t):(!1===r&&(u*=10),o+=u*t),r=n}),r&&(o+=u),o)})}function Cn(t,n,e,r){function i(t){d.push(t)}function o(){d.forEach(function(t){t.call()})}function u(){var t=c.getWeekday();c.setWeekday(7*(g.num-1)+(t>E?E+7:E))}function a(){var t=m.i[g.edge];Tn(function(t){return h(g[t])?(v=t,!1):void 0},4),"year"===v?g.e="month":("month"===v||"week"===v)&&(g.e="day"),c[(0>t.value?"endOf":"beginningOf")+yn(v)](),-2===t.value&&c.reset()}function s(){var t;Tn(function(n,e,r){if("day"===n&&(n="date"),h(g[n])){if(r>=w)return c.setTime(0/0),!1;t=t||{},t[n]=g[n],delete g[n]}}),t&&i(function(){c.set(t,!0)})}var c,f,l,d,m,g,v,w,E,b,k;return c=En(),d=[],c.utc(r),Se(t)?c.utc(t.isUTC()).setTime(t.getTime()):be(t)?c.setTime(t):p(t)?(c.set(t,!0),g=t):ke(t)&&(l=pn(n),t=On(t),l&&y(l.o?[l.o].concat(l.g):l.g,function(e,r){var o=t.match(r.q);return o?(m=r.locale,g=Sn(o,r.to),m.o=r,g.utc&&c.utc(),g.timestamp?(g=g.timestamp,!1):(r.r&&!ke(g.month)&&(ke(g.date)||hn(l,n))&&(k=g.month,g.month=g.date,g.date=k),g.year&&2===g.t.length&&(g.year=100*Re(x(En(),"FullYear")/100)-100*Re(g.year/100)+g.year),g.month&&(g.month=m.getMonth(g.month),g.shift&&!g.unit&&(g.unit=m.units[7])),g.weekday&&g.date?delete g.weekday:g.weekday&&(g.weekday=m.getWeekday(g.weekday),g.shift&&!g.unit&&(g.unit=m.units[5])),g.day&&(k=m.i[g.day])?(g.day=k.value,c.reset(),f=!0):g.day&&-1<(E=m.getWeekday(g.day))&&(delete g.day,g.num&&g.month?(i(u),g.day=1):g.weekday=E),g.date&&!be(g.date)&&(g.date=dn(m,g.date)),g.ampm&&g.ampm===m.ampm[1]&&12>g.hour?g.hour+=12:g.ampm===m.ampm[0]&&12===g.hour&&(g.hour=0),("offset_hours"in g||"offset_minutes"in g)&&(c.utc(),g.offset_minutes=g.offset_minutes||0,g.offset_minutes+=60*g.offset_hours,"-"===g.offset_sign&&(g.offset_minutes*=-1),g.minute-=g.offset_minutes),g.unit&&(f=!0,b=mn(m,g.num),w=m.units.indexOf(g.unit)%8,v=Ke.units[w],s(),g.shift&&(b*=(k=m.i[g.shift])?k.value:0),g.sign&&(k=m.i[g.sign])&&(b*=k.value),h(g.weekday)&&(c.set({weekday:g.weekday},!0),delete g.weekday),g[v]=(g[v]||0)+b),g.edge&&i(a),"-"===g.year_sign&&(g.year*=-1),Tn(function(t,n,e){n=g[t];var r=n%1;r&&(g[rr[e-1].name]=Re(r*("second"===t?1e3:60)),g[t]=xe(n))},1,4),!1)):void 0}),g?f?c.advance(g):(c._utc&&c.reset(),Ln(c,g,!0,!1,e)):("now"!==t&&(c=new ae(t)),r&&c.addMinutes(-c.getTimezoneOffset())),o(),c.utc(!1)),{c:c,set:g}}function Nn(t){var n,e=Ne(t),r=e,i=0;return Tn(function(t,o,u){n=xe(T(e/o.b(),1)),n>=1&&(r=n,i=u)},1),[r,i,t]}function In(t){var n=Nn(t.millisecondsFromNow());return(6===n[1]||5===n[1]&&4===n[0]&&t.daysFromNow()>=En().daysInMonth())&&(n[0]=Ne(t.monthsFromNow()),n[1]=6),n}function Dn(t,n,e){function r(t,e){var r=x(t,"Month");return pn(e).months[r+12*n]}xn(t,r,e),xn(yn(t),r,e,1)}function xn(t,n,e,r){cr[t]=function(t,i){var o=n(t,i);return e&&(o=o.slice(0,e)),r&&(o=o.slice(0,r).toUpperCase()+o.slice(r)),o}}function Rn(t,n,e){cr[t]=n,cr[t+t]=function(t,e){return C(n(t,e),2)},e&&(cr[t+t+t]=function(t,e){return C(n(t,e),3)},cr[t+t+t+t]=function(t,e){return C(n(t,e),4)})}function Un(t){var n=t.match(/(\{\w+\})|[^{}]+/g);sr[t]=n.map(function(t){return t.replace(/\{(\w+)\}/,function(n,e){return t=cr[e]||e,e}),t})}function _n(t,n,e,r){var i;if(!t.isValid())return"Invalid Date";if(Date[n]?n=Date[n]:Ae(n)&&(i=In(t),n=n.apply(t,i.concat(pn(r)))),!n&&e)return i=i||In(t),0===i[1]&&(i[1]=1,i[0]=1),t=pn(r),ln(t,i,0<i[2]?"future":"past");n=n||"long",("short"===n||"long"===n||"full"===n)&&(n=pn(r)[n]),sr[n]||Un(n);var o,u;for(i="",n=sr[n],o=0,e=n.length;e>o;o++)u=n[o],i+=Ae(u)?u(t,r):u;return i}function Fn(t,n,e,r,i){var o,u,a,s=0,c=0,f=0;return o=Cn(n,e,null,i),r>0&&(c=f=r,u=!0),o.c.isValid()?(o.set&&o.set.e&&(fr.forEach(function(n){n.name===o.set.e&&(s=n.b(o.c,t-o.c)-1)}),n=yn(o.set.e),(o.set.edge||o.set.shift)&&o.c["beginningOf"+n](),"month"===o.set.e&&(a=o.c.clone()["endOf"+n]().getTime()),!u&&o.set.sign&&"millisecond"!=o.set.e&&(c=50,f=-50)),u=t.getTime(),n=o.c.getTime(),a=Mn(t,n,a||n+s),u>=n-c&&a+f>=u):!1}function Mn(t,n,e){return n=new ae(n),t=new ae(e).utc(t.isUTC()),23!==x(t,"Hours")&&(n=n.getTimezoneOffset(),t=t.getTimezoneOffset(),n!==t&&(e+=(t-n).minutes())),e}function Ln(t,n,e,r,i){function o(t){return h(n[t])?n[t]:n[t+"s"]}function u(t){return h(o(t))}var a;if(be(n)&&r)n={milliseconds:n};else if(be(n))return t.setTime(n),t;h(n.date)&&(n.day=n.date),Tn(function(r,i,o){var s="day"===r;return u(r)||s&&u("weekday")?(n.e=r,a=+o,!1):(!e||"week"===r||s&&u("week")||R(t,i.method,s?1:0),void 0)}),fr.forEach(function(e){var i=e.name;e=e.method;var a;a=o(i),d(a)||(r?("week"===i&&(a=(n.day||0)+7*a,e="Date"),a=a*r+x(t,e)):"month"===i&&u("day")&&R(t,"Date",15),R(t,e,a),r&&"month"===i&&(i=a,0>i&&(i=i%12+12),i%12!=x(t,"Month")&&R(t,"Date",0)))}),r||u("day")||!u("weekday")||t.setWeekday(o("weekday"));var s;t:{switch(i){case-1:s=t>En();break t;case 1:s=t<En();break t}s=void 0}return s&&Tn(function(n,e){return!(e.k||"week"===n&&u("weekday"))||u(n)||"day"===n&&u("weekday")?void 0:(t[e.j](i),!1)},a+1),t}function Pn(t,n){var e,r=or,i={h:0,m:1,s:2};return t=t||Ke,r.replace(/{([a-z])}/g,function(r,o){var u=[],a="h"===o,s=a&&!n;return"t"===o?t.ampm.join("|"):(a&&u.push(":"),(e=t.timeSuffixes[i[o]])&&u.push(e+"\\s*"),0===u.length?"":"(?:"+u.join("|")+")"+(s?"":"?"))})}function jn(t,n,e){var r,i;return be(t[1])?r=bn(t)[0]:(r=t[0],i=t[1]),Cn(r,i,n,e).c}function Vn(t,n){function e(){return Re(this*n)}function r(){return jn(arguments)[t.j](this)}function i(){return jn(arguments)[t.j](-this)}var o=t.name,u={};u[o]=e,u[o+"s"]=e,u[o+"Before"]=i,u[o+"sBefore"]=i,u[o+"Ago"]=i,u[o+"sAgo"]=i,u[o+"After"]=r,u[o+"sAfter"]=r,u[o+"FromNow"]=r,u[o+"sFromNow"]=r,ce.extend(u)}function Gn(t,n){this.start=Wn(t),this.end=Wn(n)}function Wn(t){return Se(t)?new ae(t.getTime()):null==t?t:Se(t)?t.getTime():t.valueOf()}function Bn(t){return t=null==t?t:Se(t)?t.getTime():t.valueOf(),!!t||0===t}function zn(t,n){var e,r,i,o;return be(n)?new ae(t.getTime()+n):(e=n[0],r=n[1],i=x(t,r),o=new ae(t.getTime()),R(o,r,i+e),o)}function qn(t,n){return se.fromCharCode(t.charCodeAt(0)+n)}function Hn(t,n){return t+n}function $n(t,n,e,r,i){1/0!==n&&(t.timers||(t.timers=[]),be(n)||(n=1),t.n=!1,t.timers.push(setTimeout(function(){t.n||e.apply(r,i||[])},n)))}function Yn(t,n,e,r,i,o){var u=t.toFixed(20),a=u.search(/\./),u=u.search(/[1-9]/),a=a-u;return a>0&&(a-=1),i=_e(Ue(xe(a/3),!1===i?e.length:i),-r),r=e.charAt(i+r-1),-9>a&&(i=-3,n=Ne(a)-9,r=e.slice(0,1)),e=o?Ie(2,10*i):Ie(10,3*i),T(t/e,n||0).format()+r.trim()}function Zn(t,n,e,r){var i,o,u;(o=n.match(/^(.+?)(\[.*\])$/))?(u=o[1],n=o[2].replace(/^\[|\]$/g,"").split("]["),n.forEach(function(n){i=!n||n.match(/^\d+$/),!u&&Te(t)&&(u=t.length),m(t,u)||(t[u]=i?[]:{}),t=t[u],u=n}),!u&&i&&(u=t.length.toString()),Zn(t,u,e,r)):t[n]=r&&"true"===e?!0:r&&"false"===e?!1:e}function Qn(t,n){var e;return Te(n)||p(n)&&n.toString===he?(e=[],y(n,function(n,r){t&&(n=t+"["+n+"]"),e.push(Qn(n,r))}),e.join("&")):t?Jn(t)+"="+(Se(n)?n.getTime():Jn(n)):""}function Jn(t){return t||!1===t||0===t?encodeURIComponent(t).replace(/%20/g,"+"):""}function Xn(t,n,e){var r,i=t instanceof k?new k:{};return y(t,function(t,o){r=!1,f(n,function(n){(Oe(n)?n.test(t):p(n)?n[t]===o:t===se(n))&&(r=!0)},1),r===e&&(i[t]=o)}),i}function Kn(t){if(t=+t,0>t||1/0===t)throw new RangeError("Invalid number");return t}function te(t,n){return O(h(n)?n:" ",t)}function ne(t,n,e,r,i){var o;if(t.length<=n)return t.toString();switch(r=d(r)?"...":r,e){case"left":return t=i?ee(t,n,!0):t.slice(t.length-n),r+t;case"middle":return e=De(n/2),o=xe(n/2),n=i?ee(t,e):t.slice(0,e),t=i?ee(t,o,!0):t.slice(t.length-o),n+r+t;default:return n=i?ee(t,n):t.slice(0,n),n+r}}function ee(t,n,e){if(e)return ee(t.reverse(),n).reverse();e=ue("(?=["+S()+"])");var r=0;return t.split(e).filter(function(t){return r+=t.length,n>=r}).join("")}function re(t,n,e){return ke(n)&&(n=t.indexOf(n),-1===n&&(n=e?t.length:0)),n}var ie=Object,oe=Array,ue=RegExp,ae=Date,se=String,ce=Number,fe=Math,le="undefined"!=typeof global?global:this,he=ie.prototype.toString,de=ie.prototype.hasOwnProperty,me=ie.defineProperty&&ie.defineProperties,pe="function"==typeof ue(),ge=!("0"in new se("a")),ve={},ye=/^\[object Date|Array|String|Number|RegExp|Boolean|Arguments\]$/,we="Boolean Number String Array Date RegExp Function".split(" "),Ee=e("boolean",we[0]),be=e("number",we[1]),ke=e("string",we[2]),Te=n(we[3]),Se=n(we[4]),Oe=n(we[5]),Ae=n(we[6]);k.prototype.constructor=ie;var Ce,Ne=fe.abs,Ie=fe.pow,De=fe.ceil,xe=fe.floor,Re=fe.round,Ue=fe.min,_e=fe.max,Fe=48,Me=57,Le=65296,Pe=65305,je=".",Ve="",Ge={};r(ie),y(we,function(t,n){r(le[n])});var We,Be;for(Be=0;9>=Be;Be++)We=se.fromCharCode(Be+Le),Ve+=We,Ge[We]=se.fromCharCode(Be+Fe);Ge[","]="",Ge["．"]=je,Ge[je]=je,Ce=ue("["+Ve+"．,"+je+"]","g"),i(ie,!1,!1,{keys:function(t){var n=[];if(!p(t)&&!Oe(t)&&!Ae(t))throw new TypeError("Object required");return y(t,function(t){n.push(t)}),n}}),i(oe,!1,!1,{isArray:function(t){return Te(t)}}),i(oe,!0,!1,{every:function(t,n){var e=this.length,r=0;for(G(arguments);e>r;){if(r in this&&!t.call(n,this[r],r,this))return!1;r++}return!0},some:function(t,n){var e=this.length,r=0;for(G(arguments);e>r;){if(r in this&&t.call(n,this[r],r,this))return!0;r++}return!1},map:function(t,n){n=arguments[1];var e=this.length,r=0,i=Array(e);for(G(arguments);e>r;)r in this&&(i[r]=t.call(n,this[r],r,this)),r++;return i},filter:function(t){var n=arguments[1],e=this.length,r=0,i=[];for(G(arguments);e>r;)r in this&&t.call(n,this[r],r,this)&&i.push(this[r]),r++;return i},indexOf:function(t,n){return ke(this)?this.indexOf(t,n):j(this,t,n,1)},lastIndexOf:function(t,n){return ke(this)?this.lastIndexOf(t,n):j(this,t,n,-1)},forEach:function(t,n){var e=this.length,r=0;for(l(t);e>r;)r in this&&t.call(n,this[r],r,this),r++},reduce:function(t,n){return V(this,t,n)},reduceRight:function(t,n){return V(this,t,n,!0)}}),i(Function,!0,!1,{bind:function(t){var n,e=this,r=c(arguments,null,1);if(!Ae(this))throw new TypeError("Function.prototype.bind called on a non-function");return n=function(){return e.apply(e.prototype&&this instanceof e?this:t,r.concat(c(arguments)))},n.prototype=this.prototype,n}}),i(ae,!1,!1,{now:function(){return(new ae).getTime()}}),function(){var t=S().match(/^\s+$/);try{se.prototype.trim.call([1])}catch(n){t=!1}i(se,!0,!t,{trim:function(){return this.toString().trimLeft().trimRight()},trimLeft:function(){return this.replace(ue("^["+S()+"]+"),"")},trimRight:function(){return this.replace(ue("["+S()+"]+$"),"")}})}(),function(){var t=new ae(ae.UTC(1999,11,31)),t=t.toISOString&&"1999-12-31T00:00:00.000Z"===t.toISOString();o(ae,!0,!t,"toISOString,toJSON",function(t,n){t[n]=function(){return C(this.getUTCFullYear(),4)+"-"+C(this.getUTCMonth()+1,2)+"-"+C(this.getUTCDate(),2)+"T"+C(this.getUTCHours(),2)+":"+C(this.getUTCMinutes(),2)+":"+C(this.getUTCSeconds(),2)+"."+C(this.getUTCMilliseconds(),3)+"Z"}})}();var ze="AlphanumericSortOrder",qe="AlphanumericSortIgnore",He="AlphanumericSortIgnoreCase",$e="AlphanumericSortEquivalents",Ye="AlphanumericSortNatural";i(oe,!1,!0,{create:function(){var t=[];return c(arguments,function(n){(!g(n)&&"length"in n&&("[object Arguments]"===he.call(n)||n.callee)||!g(n)&&"length"in n&&!ke(n)&&!v(n))&&(n=oe.prototype.slice.call(n,0)),t=t.concat(n)}),t}}),i(oe,!0,!1,{find:function(t,n){return l(t),X(this,t,0,!1,!1,n)},findIndex:function(t,n){var e;return l(t),e=X(this,t,0,!1,!0,n),d(e)?-1:e}}),i(oe,!0,!0,{findFrom:function(t,n,e){return X(this,t,n,e)},findIndexFrom:function(t,n,e){return n=X(this,t,n,e,!0),d(n)?-1:n},findAll:function(t,n,e){var r,i=[];return 0<this.length&&(r=Y(t),Q(this,function(t,n,e){r(t,n,e)&&i.push(t)},n,e)),i},count:function(t){return d(t)?this.length:this.findAll(t).length},removeAt:function(t,n){return d(t)?this:(d(n)&&(n=t),this.splice(t,n-t+1),this)},include:function(t,n){return this.clone().add(t,n)},exclude:function(){return oe.prototype.remove.apply(this.clone(),arguments)},clone:function(){return E([],this)},unique:function(t){return K(this,t)},flatten:function(t){return nn(this,t)},union:function(){return K(this.concat(en(arguments)))},intersect:function(){return tn(this,en(arguments),!1)},subtract:function(){return tn(this,en(arguments),!0)},at:function(){return M(this,arguments)},first:function(t){return d(t)?this[0]:(0>t&&(t=0),this.slice(0,t))},last:function(t){return d(t)?this[this.length-1]:this.slice(0>this.length-t?0:this.length-t)},from:function(t){return this.slice(t)},to:function(t){return d(t)&&(t=this.length),this.slice(0,t)},min:function(t,n){return un(this,t,"min",n)},max:function(t,n){return un(this,t,"max",n)},least:function(t,n){return un(this.groupBy.apply(this,[t]),"length","min",n)},most:function(t,n){return un(this.groupBy.apply(this,[t]),"length","max",n)},sum:function(t){return t=t?this.map(t):this,0<t.length?t.reduce(function(t,n){return t+n}):0},average:function(t){return t=t?this.map(t):this,0<t.length?t.sum()/t.length:0},inGroups:function(t,n){var e=1<arguments.length,r=this,i=[],o=De(this.length/t);return w(t,function(t){t*=o;var u=r.slice(t,t+o);e&&u.length<o&&w(o-u.length,function(){u=u.add(n)}),i.push(u)}),i},inGroupsOf:function(t,n){var e,r=[],i=this.length,o=this;return 0===i||0===t?o:(d(t)&&(t=1),d(n)&&(n=null),w(De(i/t),function(i){for(e=o.slice(t*i,t*i+t);e.length<t;)e.push(n);r.push(e)}),r)},isEmpty:function(){return 0==this.compact().length},sortBy:function(t,n){var e=this.clone();return e.sort(function(r,i){var o,u;return o=Z(r,t,e,[r]),u=Z(i,t,e,[i]),(ke(o)&&ke(u)?an(o,u):u>o?-1:o>u?1:0)*(n?-1:1)}),e},randomize:function(){for(var t,n,e=this.concat(),r=e.length;r;)t=0|fe.random()*r,n=e[--r],e[r]=e[t],e[t]=n;return e},zip:function(){var t=c(arguments);return this.map(function(n,e){return[n].concat(t.map(function(t){return e in t?t[e]:null}))})},sample:function(t){var n=this.randomize();return 0<arguments.length?n.slice(0,t):n[0]},each:function(t,n,e){return Q(this,t,n,e),this},add:function(t,n){return(!be(ce(n))||isNaN(n))&&(n=this.length),oe.prototype.splice.apply(this,[n,0].concat(t)),this},remove:function(){var t=this;return c(arguments,function(n){var e=0;for(n=Y(n);e<t.length;)n(t[e],e,t)?t.splice(e,1):e++}),t},compact:function(t){var n=[];return Q(this,function(e){Te(e)?n.push(e.compact()):t&&e?n.push(e):t||null==e||e.valueOf()!==e.valueOf()||n.push(e)}),n},groupBy:function(t,n){var e,r=this,i={};return Q(r,function(n,o){e=Z(n,t,r,[n,o,r]),i[e]||(i[e]=[]),i[e].push(n)}),n&&y(i,n),i},none:function(){return!this.any.apply(this,arguments)}}),i(oe,!0,!0,{all:oe.prototype.every,any:oe.prototype.some,insert:oe.prototype.add}),i(ie,!1,!0,{map:function(t,n){var e,r,i={};for(e in t)m(t,e)&&(r=t[e],i[e]=Z(r,n,t,[e,r,t]));return i},reduce:function(t){var n=ie.keys(b(t)).map(function(n){return t[n]});return n.reduce.apply(n,c(arguments,null,1))},each:function(t,n){return l(n),y(t,n),t},size:function(t){return ie.keys(b(t)).length}});var Ze="any all none count find findAll isEmpty".split(" "),Qe="sum average min max least most".split(" "),Je=["map","reduce","size"],Xe=Ze.concat(Qe).concat(Je);!function(){function t(){var t=arguments;return 0<t.length&&!Ae(t[0])}var n=oe.prototype.map;o(oe,!0,t,"every,all,some,filter,any,none,find,findIndex",function(t,n){var e=oe.prototype[n];t[n]=function(t){var n=Y(t);return e.call(this,function(t,e){return n(t,e,this)})}}),i(oe,!0,t,{map:function(t){return n.call(this,function(n,e){return Z(n,t,this,[n,e,this])})}})}(),function(){oe[ze]="AÁÀÂÃĄBCĆČÇDĎÐEÉÈĚÊËĘFGĞHıIÍÌİÎÏJKLŁMNŃŇÑOÓÒÔPQRŘSŚŠŞTŤUÚÙŮÛÜVWXYÝZŹŻŽÞÆŒØÕÅÄÖ".split("").map(function(t){return t+t.toLowerCase()}).join("");var t={};Q("AÁÀÂÃÄ CÇ EÉÈÊË IÍÌİÎÏ OÓÒÔÕÖ Sß UÚÙÛÜ".split(" "),function(n){var e=n.charAt(0);Q(n.slice(1).split(""),function(n){t[n]=e,t[n.toLowerCase()]=e.toLowerCase()})}),oe[Ye]=!0,oe[He]=!0,oe[$e]=t}(),cn(Ze),cn(Qe,!0),P(Je,k),oe.AlphanumericSort=an;var Ke,tr,nr,er,rr,ir="ampm hour minute second ampm utc offset_sign offset_hours offset_minutes ampm".split(" "),or="({t})?\\s*(\\d{1,2}(?:[,.]\\d+)?)(?:{h}([0-5]\\d(?:[,.]\\d+)?)?{m}(?::?([0-5]\\d(?:[,.]\\d+)?){s})?\\s*(?:({t})|(Z)|(?:([+-])(\\d{2,2})(?::?(\\d{2,2}))?)?)?|\\s*({t}))",ur={},ar=[],sr={},cr={yyyy:function(t){return x(t,"FullYear")},yy:function(t){return x(t,"FullYear")%100},ord:function(t){return t=x(t,"Date"),t+N(t)},tz:function(t){return t.getUTCOffset()},isotz:function(t){return t.getUTCOffset(!0)},Z:function(t){return t.getUTCOffset()},ZZ:function(t){return t.getUTCOffset().replace(/(\d{2})$/,":$1")}},fr=[{name:"year",method:"FullYear",k:!0,b:function(t){return 864e5*(365+(t?t.isLeapYear()?1:0:.25))}},{name:"month",error:.919,method:"Month",k:!0,b:function(t,n){var e,r=30.4375;return t&&(e=t.daysInMonth(),n<=e.days()&&(r=e)),864e5*r}},{name:"week",method:"ISOWeek",b:t(6048e5)},{name:"day",error:.958,method:"Date",k:!0,b:t(864e5)},{name:"hour",method:"Hours",b:t(36e5)},{name:"minute",method:"Minutes",b:t(6e4)},{name:"second",method:"Seconds",b:t(1e3)},{name:"millisecond",method:"Milliseconds",b:t(1)}],lr={};fn.prototype={getMonth:function(t){return be(t)?t-1:this.months.indexOf(t)%12},getWeekday:function(t){return this.weekdays.indexOf(t)%7},addFormat:function(t,n,e,r,i){var o,u=e||[],a=this;t=t.replace(/\s+/g,"[,. ]*"),t=t.replace(/\{([^,]+?)\}/g,function(t,n){var r,i,o,s=n.match(/\?$/);o=n.match(/^(\d+)\??$/);var c=n.match(/(\d)(?:-(\d))?/),f=n.replace(/[^a-z]+$/,"");return o?r=a.tokens[o[1]]:a[f]?r=a[f]:a[f+"s"]&&(r=a[f+"s"],c&&(i=[],r.forEach(function(t,n){var e=n%(a.units?8:r.length);e>=c[1]&&e<=(c[2]||c[1])&&i.push(t)}),r=i),r=wn(r)),o?o="(?:"+r+")":(e||u.push(f),o="("+r+")"),s&&(o+="?"),o}),n?(n=Pn(a,i),i=["t","[\\s\\u3000]"].concat(a.timeMarker),o=t.match(/\\d\{\d,\d\}\)+\??$/),vn(a,"(?:"+n+")[,\\s\\u3000]+?"+t,ir.concat(u),r),vn(a,t+"(?:[,\\s]*(?:"+i.join("|")+(o?"+":"*")+")"+n+")?",u.concat(ir),r)):vn(a,t,u,r)}},i(ae,!1,!0,{create:function(){return jn(arguments)},past:function(){return jn(arguments,-1)},future:function(){return jn(arguments,1)},addLocale:function(t,n){return gn(t,n)},setLocale:function(t){var n=pn(t,!1);return tr=n,t&&t!=n.code&&(n.code=t),n},getLocale:function(t){return t?pn(t,!1):tr},addFormat:function(t,n,e){vn(pn(e),t,n)}}),i(ae,!0,!0,{set:function(){var t=bn(arguments);return Ln(this,t[0],t[1])},setWeekday:function(t){return d(t)?void 0:R(this,"Date",x(this,"Date")+t-x(this,"Day"))},setISOWeek:function(t){var n=x(this,"Day")||7;
return d(t)?void 0:(this.set({month:0,date:4}),this.set({weekday:1}),t>1&&this.addWeeks(t-1),1!==n&&this.advance({days:n-1}),this.getTime())},getISOWeek:function(){var t;t=this.clone();var n=x(t,"Day")||7;return t.addDays(4-n).reset(),1+xe(t.daysSince(t.clone().beginningOfYear())/7)},beginningOfISOWeek:function(){var t=this.getDay();return 0===t?t=-6:1!==t&&(t=1),this.setWeekday(t),this.reset()},endOfISOWeek:function(){return 0!==this.getDay()&&this.setWeekday(7),this.endOfDay()},getUTCOffset:function(t){var n=this._utc?0:this.getTimezoneOffset(),e=!0===t?":":"";return!n&&t?"Z":C(xe(-n/60),2,!0)+e+C(Ne(n%60),2)},utc:function(t){return s(this,"_utc",!0===t||0===arguments.length),this},isUTC:function(){return!!this._utc||0===this.getTimezoneOffset()},advance:function(){var t=bn(arguments,!0);return Ln(this,t[0],t[1],1)},rewind:function(){var t=bn(arguments,!0);return Ln(this,t[0],t[1],-1)},isValid:function(){return!isNaN(this.getTime())},isAfter:function(t,n){return this.getTime()>ae.create(t).getTime()-(n||0)},isBefore:function(t,n){return this.getTime()<ae.create(t).getTime()+(n||0)},isBetween:function(t,n,e){var r=this.getTime();t=ae.create(t).getTime();var i=ae.create(n).getTime();return n=Ue(t,i),t=_e(t,i),e=e||0,r>n-e&&t+e>r},isLeapYear:function(){var t=x(this,"FullYear");return 0===t%4&&0!==t%100||0===t%400},daysInMonth:function(){return 32-x(new ae(x(this,"FullYear"),x(this,"Month"),32),"Date")},format:function(t,n){return _n(this,t,!1,n)},relative:function(t,n){return ke(t)&&(n=t,t=null),_n(this,t,!0,n)},is:function(t,n,e){var r,i;if(this.isValid()){if(ke(t))switch(t=t.trim().toLowerCase(),i=this.clone().utc(e),!0){case"future"===t:return this.getTime()>En().getTime();case"past"===t:return this.getTime()<En().getTime();case"weekday"===t:return 0<x(i,"Day")&&6>x(i,"Day");case"weekend"===t:return 0===x(i,"Day")||6===x(i,"Day");case-1<(r=Ke.weekdays.indexOf(t)%7):return x(i,"Day")===r;case-1<(r=Ke.months.indexOf(t)%12):return x(i,"Month")===r}return Fn(this,t,null,n,e)}},reset:function(t){var n,e={};return t=t||"hours","date"===t&&(t="days"),n=fr.some(function(n){return t===n.name||t===n.name+"s"}),e[t]=t.match(/^days?/)?1:0,n?this.set(e,!0):this},clone:function(){var t=new ae(this.getTime());return t.utc(!!this._utc),t}}),i(ae,!0,!0,{iso:function(){return this.toISOString()},getWeekday:ae.prototype.getDay,getUTCWeekday:ae.prototype.getUTCDay}),i(ce,!0,!0,{duration:function(t){return t=pn(t),ln(t,Nn(this),"duration")}}),Ke=tr=ae.addLocale("en",{plural:!0,timeMarker:"at",ampm:"am,pm",months:"January,February,March,April,May,June,July,August,September,October,November,December",weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",units:"millisecond:|s,second:|s,minute:|s,hour:|s,day:|s,week:|s,month:|s,year:|s",numbers:"one,two,three,four,five,six,seven,eight,nine,ten",articles:"a,an,the",tokens:"the,st|nd|rd|th,of","short":"{Month} {d}, {yyyy}","long":"{Month} {d}, {yyyy} {h}:{mm}{tt}",full:"{Weekday} {Month} {d}, {yyyy} {h}:{mm}:{ss}{tt}",past:"{num} {unit} {sign}",future:"{num} {unit} {sign}",duration:"{num} {unit}",modifiers:[{name:"sign",src:"ago|before",value:-1},{name:"sign",src:"from now|after|from|in|later",value:1},{name:"edge",src:"last day",value:-2},{name:"edge",src:"end",value:-1},{name:"edge",src:"first day|beginning",value:1},{name:"shift",src:"last",value:-1},{name:"shift",src:"the|this",value:0},{name:"shift",src:"next",value:1}],dateParse:["{month} {year}","{shift} {unit=5-7}","{0?} {date}{1}","{0?} {edge} of {shift?} {unit=4-7?}{month?}{year?}"],timeParse:"{num} {unit} {sign};{sign} {num} {unit};{0} {num}{1} {day} of {month} {year?};{weekday?} {month} {date}{1?} {year?};{date} {month} {year};{date} {month};{shift} {weekday};{shift} week {weekday};{weekday} {2?} {shift} week;{num} {unit=4-5} {sign} {day};{0?} {date}{1} of {month};{0?}{month?} {date?}{1?} of {shift} {unit=6-7}".split(";")}),rr=fr.concat().reverse(),er=fr.concat(),er.splice(2,1),o(ae,!0,!0,fr,function(t,n,e){function r(t){t/=s;var e=t%1,r=n.error||.999;return e&&Ne(e%1)>r&&(t=Re(t)),0>t?De(t):xe(t)}var i,o,u=n.name,a=yn(u),s=n.b();n.j="add"+a+"s",i=function(t,n){return r(this.getTime()-ae.create(t,n).getTime())},o=function(t,n){return r(ae.create(t,n).getTime()-this.getTime())},t[u+"sAgo"]=o,t[u+"sUntil"]=o,t[u+"sSince"]=i,t[u+"sFromNow"]=i,t[n.j]=function(t,n){var e={};return e[u]=t,this.advance(e,n)},Vn(n,s),3>e&&["Last","This","Next"].forEach(function(n){t["is"+n+a]=function(){return Fn(this,n+" "+u,"en")}}),4>e&&(t["beginningOf"+a]=function(){var t={};switch(u){case"year":t.year=x(this,"FullYear");break;case"month":t.month=x(this,"Month");break;case"day":t.day=x(this,"Date");break;case"week":t.weekday=0}return this.set(t,!0)},t["endOf"+a]=function(){var t={hours:23,minutes:59,seconds:59,milliseconds:999};switch(u){case"year":t.month=11,t.day=31;break;case"month":t.day=this.daysInMonth();break;case"week":t.weekday=6}return this.set(t,!0)})}),Ke.addFormat("([+-])?(\\d{4,4})[-.]?{full_month}[-.]?(\\d{1,2})?",!0,["year_sign","year","month","date"],!1,!0),Ke.addFormat("(\\d{1,2})[-.\\/]{full_month}(?:[-.\\/](\\d{2,4}))?",!0,["date","month","year"],!0),Ke.addFormat("{full_month}[-.](\\d{4,4})",!1,["month","year"]),Ke.addFormat("\\/Date\\((\\d+(?:[+-]\\d{4,4})?)\\)\\/",!1,["timestamp"]),Ke.addFormat(Pn(Ke),!1,ir),ar=Ke.g.slice(0,7).reverse(),Ke.g=Ke.g.slice(7).concat(ar),Rn("f",function(t){return x(t,"Milliseconds")},!0),Rn("s",function(t){return x(t,"Seconds")}),Rn("m",function(t){return x(t,"Minutes")}),Rn("h",function(t){return x(t,"Hours")%12||12}),Rn("H",function(t){return x(t,"Hours")}),Rn("d",function(t){return x(t,"Date")}),Rn("M",function(t){return x(t,"Month")+1}),function(){function t(t,n){var e=x(t,"Hours");return pn(n).ampm[xe(e/12)]||""}xn("t",t,1),xn("tt",t),xn("T",t,1,1),xn("TT",t,null,2)}(),function(){function t(t,n){var e=x(t,"Day");return pn(n).weekdays[e]}xn("dow",t,3),xn("Dow",t,3,1),xn("weekday",t),xn("Weekday",t,null,1)}(),Dn("mon",0,3),Dn("month",0),Dn("month2",1),Dn("month3",2),cr.ms=cr.f,cr.milliseconds=cr.f,cr.seconds=cr.s,cr.minutes=cr.m,cr.hours=cr.h,cr["24hr"]=cr.H,cr["12hr"]=cr.h,cr.date=cr.d,cr.day=cr.d,cr.year=cr.yyyy,o(ae,!0,!0,"short,long,full",function(t,n){t[n]=function(t){return _n(this,n,!1,t)}}),"〇一二三四五六七八九十百千万".split("").forEach(function(t,n){n>9&&(n=Ie(10,n-9)),ur[t]=n}),E(ur,Ge),nr=ue("([期週周])?([〇一二三四五六七八九十百千万"+Ve+"]+)(?!昨)","g"),function(){var t=Ke.weekdays.slice(0,7),n=Ke.months.slice(0,12);o(ae,!0,!0,"today yesterday tomorrow weekday weekend future past".split(" ").concat(t).concat(n),function(t,n){t["is"+yn(n)]=function(t){return this.is(n,0,t)}})}(),ae.utc||(ae.utc={create:function(){return jn(arguments,0,!0)},past:function(){return jn(arguments,-1,!0)},future:function(){return jn(arguments,1,!0)}}),i(ae,!1,!0,{RFC1123:"{Dow}, {dd} {Mon} {yyyy} {HH}:{mm}:{ss} {tz}",RFC1036:"{Weekday}, {dd}-{Mon}-{yy} {HH}:{mm}:{ss} {tz}",ISO8601_DATE:"{yyyy}-{MM}-{dd}",ISO8601_DATETIME:"{yyyy}-{MM}-{dd}T{HH}:{mm}:{ss}.{fff}{isotz}"}),Gn.prototype.toString=function(){return this.isValid()?this.start+".."+this.end:"Invalid Range"},i(Gn,!0,!0,{isValid:function(){return Bn(this.start)&&Bn(this.end)&&typeof this.start==typeof this.end},span:function(){return this.isValid()?Ne((ke(this.end)?this.end.charCodeAt(0):this.end)-(ke(this.start)?this.start.charCodeAt(0):this.start))+1:0/0},contains:function(t){return null==t?!1:t.start&&t.end?t.start>=this.start&&t.start<=this.end&&t.end>=this.start&&t.end<=this.end:t>=this.start&&t<=this.end},every:function(t,n){var e,r=this.start,i=this.end,o=r>i,u=r,a=0,s=[];for(Ae(t)&&(n=t,t=null),t=t||1,be(r)?e=Hn:ke(r)?e=qn:Se(r)&&(e=t,be(e)?t=e:(r=e.toLowerCase().match(/^(\d+)?\s?(\w+?)s?$/i),e=parseInt(r[1])||1,r=r[2].slice(0,1).toUpperCase()+r[2].slice(1),r.match(/hour|minute|second/i)?r+="s":"Year"===r?r="FullYear":"Day"===r&&(r="Date"),t=[e,r]),e=zn),o&&t>0&&(t*=-1);o?u>=i:i>=u;)s.push(u),n&&n(u,a),u=e(u,t),a++;return s},union:function(t){return new Gn(this.start<t.start?this.start:t.start,this.end>t.end?this.end:t.end)},intersect:function(t){return t.start>this.end||t.end<this.start?new Gn(0/0,0/0):new Gn(this.start>t.start?this.start:t.start,this.end<t.end?this.end:t.end)},clone:function(){return new Gn(this.start,this.end)},clamp:function(t){var n=this.start,e=this.end,r=n>e?e:n,n=n>e?n:e;return Wn(r>t?r:t>n?n:t)}}),[ce,se,ae].forEach(function(t){i(t,!1,!0,{range:function(n,e){return t.create&&(n=t.create(n),e=t.create(e)),new Gn(n,e)}})}),i(ce,!0,!0,{upto:function(t,n,e){return ce.range(this,t).every(e,n)},clamp:function(t,n){return new Gn(t,n).clamp(this)},cap:function(t){return this.clamp(void 0,t)}}),i(ce,!0,!0,{downto:ce.prototype.upto}),i(oe,!1,function(t){return t instanceof Gn},{create:function(t){return t.every()}}),i(Function,!0,!0,{lazy:function(t,n,e){function r(){return c.length<e-(f&&n?1:0)&&c.push([this,arguments]),f||(f=!0,n?i():$n(r,o,i)),a}var i,o,u,a,s=this,c=[],f=!1;return t=t||1,e=e||1/0,o=De(t),u=Re(o/t)||1,i=function(){var t,n=c.length;if(0!=n){for(t=_e(n-u,0);n>t;)a=Function.prototype.apply.apply(s,c.shift()),n--;$n(r,o,function(){f=!1,i()})}},r},throttle:function(t){return this.lazy(t,!0,1)},debounce:function(t){function n(){n.cancel(),$n(n,t,e,this,arguments)}var e=this;return n},delay:function(t){var n=c(arguments,null,1);return $n(this,t,this,this,n),this},every:function(t){function n(){e.apply(e,r),$n(e,t,n)}var e=this,r=arguments,r=1<r.length?c(r,null,1):[];return $n(e,t,n),e},cancel:function(){var t,n=this.timers;if(Te(n))for(;t=n.shift();)clearTimeout(t);return this.n=!0,this},after:function(t){var n=this,e=0,r=[];if(be(t)){if(0===t)return n.call(),n}else t=1;return function(){var i;return r.push(c(arguments)),e++,e==t?(i=n.call(this,r),e=0,r=[],i):void 0}},once:function(){return this.throttle(1/0,!0)},fill:function(){var t=this,n=c(arguments);return function(){var e=c(arguments);return n.forEach(function(t,n){(null!=t||n>=e.length)&&e.splice(n,0,t)}),t.apply(this,e)}}}),i(ce,!1,!0,{random:function(t,n){var e,r;return 1==arguments.length&&(n=t,t=0),e=Ue(t||0,d(n)?1:n),r=_e(t||0,d(n)?1:n)+1,xe(fe.random()*(r-e)+e)}}),i(ce,!0,!0,{log:function(t){return fe.log(this)/(t?fe.log(t):1)},abbr:function(t){return Yn(this,t,"kmbt",0,4)},metric:function(t,n){return Yn(this,t,"nμm kMGTPE",4,d(n)?1:n)},bytes:function(t,n){return Yn(this,t,"kMGTPE",0,d(n)?4:n,!0)+"B"},isInteger:function(){return 0==this%1},isOdd:function(){return!isNaN(this)&&!this.isMultipleOf(2)},isEven:function(){return this.isMultipleOf(2)},isMultipleOf:function(t){return 0===this%t},format:function(t,n,e){var r,i,o,u="";for(d(n)&&(n=","),d(e)&&(e="."),r=(be(t)?T(this,t||0).toFixed(_e(t,0)):this.toString()).replace(/^-/,"").split("."),i=r[0],o=r[1],r=i.length;r>0;r-=3)r<i.length&&(u=n+u),u=i.slice(_e(0,r-3),r)+u;return o&&(u+=e+O("0",(t||0)-o.length)+o),(0>this?"-":"")+u},hex:function(t){return this.pad(t||1,!1,16)},times:function(t){if(t)for(var n=0;this>n;n++)t.call(this,n);return this.toNumber()},chr:function(){return se.fromCharCode(this)},pad:function(t,n,e){return C(this,t,n,e)},ordinalize:function(){var t=Ne(this),t=parseInt(t.toString().slice(-2));return this+N(t)},toNumber:function(){return parseFloat(this,10)}}),function(){function t(t){return function(n){return n?T(this,n,t):t(this)}}i(ce,!0,!0,{ceil:t(De),round:t(Re),floor:t(xe)}),o(ce,!0,!0,"abs,pow,sin,asin,cos,acos,tan,atan,exp,pow,sqrt",function(t,n){t[n]=function(t,e){return fe[n](this,t,e)}})}();var hr=["isObject","isNaN"],dr="keys values select reject each merge clone equal watch tap has toQueryString".split(" ");i(ie,!1,!0,{watch:function(t,n,e){if(me){var r=t[n];ie.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){return r},set:function(i){r=e.call(t,n,r,i)}})}}}),i(ie,!1,function(){return 1<arguments.length},{keys:function(t,n){var e=ie.keys(t);return e.forEach(function(e){n.call(t,e,t[e])}),e}}),i(ie,!1,!0,{isObject:function(t){return v(t)},isNaN:function(t){return be(t)&&t.valueOf()!==t.valueOf()},equal:function(t,n){return _(t,n)},extended:function(t){return new k(t)},merge:function(t,n,e,r){var i,o,u,a,s,c,f;if(t&&"string"!=typeof n)for(i in n)if(m(n,i)&&t){if(a=n[i],s=t[i],c=h(s),o=p(a),u=p(s),f=c&&!1===r?s:a,c&&Ae(r)&&(f=r.call(n,i,s,a)),e&&(o||u))if(Se(a))f=new ae(a.getTime());else{if(!Oe(a)){u||(t[i]=oe.isArray(a)?[]:{}),ie.merge(t[i],a,e,r);continue}f=new ue(a.source,I(a))}t[i]=f}return t},values:function(t,n){var e=[];return y(t,function(r,i){e.push(i),n&&n.call(t,i)}),e},clone:function(t,n){var e;if(!p(t))return t;if(e=he.call(t),Se(t,e)&&t.clone)return t.clone();if(Se(t,e)||Oe(t,e))return new t.constructor(t);if(t instanceof k)e=new k;else if(Te(t,e))e=[];else{if(!v(t,e))throw new TypeError("Clone must be a basic data type.");e={}}return ie.merge(e,t,n)},fromQueryString:function(t,n){var e=ie.extended();return t=t&&t.toString?t.toString():"",t.replace(/^.*?\?/,"").split("&").forEach(function(t){t=t.split("="),2===t.length&&Zn(e,t[0],decodeURIComponent(t[1]),n)}),e},toQueryString:function(t,n){return Qn(n,t)},tap:function(t,n){var e=n;return Ae(n)||(e=function(){n&&t[n]()}),e.call(t,t),t},has:function(t,n){return m(t,n)},select:function(t){return Xn(t,arguments,!0)},reject:function(t){return Xn(t,arguments,!1)}}),o(ie,!1,!0,we,function(t,n){var e="is"+n;hr.push(e),t[e]=ve[n]}),i(ie,!1,function(){return 0===arguments.length},{extend:function(){var t=hr.concat(dr);"undefined"!=typeof Xe&&(t=t.concat(Xe)),P(t,ie)}}),P(dr,k),i(ue,!1,!0,{escape:function(t){return D(t)}}),i(ue,!0,!0,{getFlags:function(){return I(this)},setFlags:function(t){return ue(this.source,t)},addFlag:function(t){return this.setFlags(I(this,t))},removeFlag:function(t){return this.setFlags(I(this).replace(t,""))}});var mr,pr;i(se,!0,!1,{repeat:function(t){return t=Kn(t),O(this,t)}}),i(se,!0,function(t){return Oe(t)||2<arguments.length},{startsWith:function(t){var n=arguments,e=n[1],n=n[2],r=this;return e&&(r=r.slice(e)),d(n)&&(n=!0),e=Oe(t)?t.source.replace("^",""):D(t),ue("^"+e,n?"":"i").test(r)},endsWith:function(t){var n=arguments,e=n[1],n=n[2],r=this;return h(e)&&(r=r.slice(0,e)),d(n)&&(n=!0),e=Oe(t)?t.source.replace("$",""):D(t),ue(e+"$",n?"":"i").test(r)}}),i(se,!0,!0,{escapeRegExp:function(){return D(this)},escapeURL:function(t){return t?encodeURIComponent(this):encodeURI(this)},unescapeURL:function(t){return t?decodeURI(this):decodeURIComponent(this)},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2f;")},unescapeHTML:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#x2f;/g,"/").replace(/&amp;/g,"&")},encodeBase64:function(){return mr(unescape(encodeURIComponent(this)))},decodeBase64:function(){return decodeURIComponent(escape(pr(this)))},each:function(t,n){var e,r,i;if(Ae(t)?(n=t,t=/[\s\S]/g):t?ke(t)?t=ue(D(t),"gi"):Oe(t)&&(t=ue(t.source,I(t,"g"))):t=/[\s\S]/g,e=this.match(t)||[],n)for(r=0,i=e.length;i>r;r++)e[r]=n.call(this,e[r],r,e)||e[r];return e},shift:function(t){var n="";return t=t||0,this.codes(function(e){n+=se.fromCharCode(e+t)}),n},codes:function(t){var n,e,r=[];for(n=0,e=this.length;e>n;n++){var i=this.charCodeAt(n);r.push(i),t&&t.call(this,i,n)}return r},chars:function(t){return this.each(t)},words:function(t){return this.trim().each(/\S+/g,t)},lines:function(t){return this.trim().each(/^.*$/gm,t)},paragraphs:function(t){var n=this.trim().split(/[\r\n]{2,}/);return n=n.map(function(n){if(t)var e=t.call(n);return e?e:n})},isBlank:function(){return 0===this.trim().length},has:function(t){return-1!==this.search(Oe(t)?t:D(t))},add:function(t,n){return n=d(n)?this.length:n,this.slice(0,n)+t+this.slice(n)},remove:function(t){return this.replace(t,"")},reverse:function(){return this.split("").reverse().join("")},compact:function(){return this.trim().replace(/([\r\n\s\u3000])+/g,function(t,n){return"　"===n?n:" "})},at:function(){return M(this,arguments,!0)},from:function(t){return this.slice(re(this,t,!0))},to:function(t){return d(t)&&(t=this.length),this.slice(0,re(this,t))},dasherize:function(){return this.underscore().replace(/_/g,"-")},underscore:function(){return this.replace(/[-\s]+/g,"_").replace(se.Inflector&&se.Inflector.acronymRegExp,function(t,n){return(n>0?"_":"")+t.toLowerCase()}).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").toLowerCase()},camelize:function(t){return this.underscore().replace(/(^|_)([^_]+)/g,function(n,e,r,i){return n=(n=se.Inflector)&&n.acronyms[r],n=ke(n)?n:void 0,i=!1!==t||i>0,n?i?n:n.toLowerCase():i?r.capitalize():r})},spacify:function(){return this.underscore().replace(/_/g," ")},stripTags:function(){var t=this;return f(0<arguments.length?arguments:[""],function(n){t=t.replace(ue("</?"+D(n)+"[^<>]*>","gi"),"")}),t},removeTags:function(){var t=this;return f(0<arguments.length?arguments:["\\S+"],function(n){n=ue("<("+n+")[^<>]*(?:\\/>|>.*?<\\/\\1>)","gi"),t=t.replace(n,"")}),t},truncate:function(t,n,e){return ne(this,t,n,e)},truncateOnWord:function(t,n,e){return ne(this,t,n,e,!0)},pad:function(t,n){var e,r;return t=Kn(t),e=_e(0,t-this.length)/2,r=xe(e),e=De(e),te(r,n)+this+te(e,n)},padLeft:function(t,n){return t=Kn(t),te(_e(0,t-this.length),n)+this},padRight:function(t,n){return t=Kn(t),this+te(_e(0,t-this.length),n)},first:function(t){return d(t)&&(t=1),this.substr(0,t)},last:function(t){return d(t)&&(t=1),this.substr(0>this.length-t?0:this.length-t)},toNumber:function(t){return A(this,t)},capitalize:function(t){var n;return this.toLowerCase().replace(t?/[^']/g:/^\S/,function(t){var e,r=t.toUpperCase();return e=n?t:r,n=r!==t,e})},assign:function(){var t={};return f(arguments,function(n,e){p(n)?E(t,n):t[e+1]=n}),this.replace(/\{([^{]+?)\}/g,function(n,e){return m(t,e)?t[e]:n})}}),i(se,!0,!0,{insert:se.prototype.add}),function(t){if(le.btoa)mr=le.btoa,pr=le.atob;else{var n=/[^A-Za-z0-9\+\/\=]/g;mr=function(n){var e,r,i,o,u,a,s="",c=0;do e=n.charCodeAt(c++),r=n.charCodeAt(c++),i=n.charCodeAt(c++),o=e>>2,e=(3&e)<<4|r>>4,u=(15&r)<<2|i>>6,a=63&i,isNaN(r)?u=a=64:isNaN(i)&&(a=64),s=s+t.charAt(o)+t.charAt(e)+t.charAt(u)+t.charAt(a);while(c<n.length);return s},pr=function(e){var r,i,o,u,a,s="",c=0;if(e.match(n))throw Error("String contains invalid base64 characters");e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do r=t.indexOf(e.charAt(c++)),i=t.indexOf(e.charAt(c++)),u=t.indexOf(e.charAt(c++)),a=t.indexOf(e.charAt(c++)),r=r<<2|i>>4,i=(15&i)<<4|u>>2,o=(3&u)<<6|a,s+=se.fromCharCode(r),64!=u&&(s+=se.fromCharCode(i)),64!=a&&(s+=se.fromCharCode(o));while(c<e.length);return s}}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")}(),e("sugar",function(){}),e("utils/environment",[],function(){function t(t){return t===!0||"string"==typeof t}return{APP_NAME:"SonosJS",DEBUG:t(true),LOG_LEVELS:{OFF:0,ERROR:1,WARNING:2,INFO:4,TRACE:8,DEBUG:16},LOG_LEVEL:t(true)?23:1,USER_AGENT:"{1} UPnP/1.1 SonosJS/0.0.1",VERSION:"0.0.1"}}),e("log",["require","utils/environment"],function(t){function n(t){return(t&o.LOG_LEVEL)===t}function e(t,n){var e=[o.APP_NAME,n,(new Date).toISOString(),t].join("	");console.log(e)}function r(){var t={};return t.debug=function(t,r){n(o.LOG_LEVELS.DEBUG)&&(e(t,"DEBUG"),r&&console.log(r))},t.trace=function(t){n(o.LOG_LEVELS.TRACE)&&e(t,"TRACE")},t.info=function(t){n(o.LOG_LEVELS.INFO)&&e(t,"INFO")},t.warning=function(t){n(o.LOG_LEVELS.WARNING)&&e(t,"WARNING")},t.error=function(t){if(n(o.LOG_LEVELS.ERROR))throw e(t,"ERROR"),t},t}function i(){function t(t,n){var e=["[",n,"]",(new Date).toISOString(),t].join("	");console.log(e)}var e={};return e.debug=function(){},e.trace=function(){},e.info=function(){},e.warning=function(){},e.error=function(e){n(o.LOG_LEVELS.ERROR)&&t(e,"ERROR")},e}var o=t("utils/environment"),u=o.DEBUG?r():i();return{debug:u.debug,trace:u.trace,info:u.info,warning:u.warning,error:u.error}}),e("net/base",[],function(){function t(t){t=t||"";var n=t.codes().map(function(t){return 255&t});return new Uint8Array(n).buffer}function n(t){if(!t)return"";var n=new Uint8Array(t);return String.fromCharCode.apply(null,n)}return{toBuffer:t,fromBuffer:n}}),e("net/chrome",["require","log","net/base","utils/environment"],function(t){function n(){function t(){i.isClosed()||chrome.socket.recvFrom(o,function(u){if(u.resultCode<0)return e.error("Failed to read from socket {1}. Error code: {2}".assign(o,u.resultCode)),i.close(),void 0;t();var a=r.fromBuffer(u.data);n&&n(a)})}var n,i={},o=0;return i.isClosed=function(){return 0===o},i.close=function(){i.isClosed()||(e.debug("Closing socket '{1}'".assign(o)),chrome.socket.destroy(o),o=0)},i.joinMulticast=function(r,u,a){n=a,chrome.socket.create("udp",{},function(n){o=n.socketId,chrome.socket.bind(o,"0.0.0.0",0,function(){e.debug("Joining multicast group {ip}:{port} on socket '{socket}'.".assign({ip:r,port:u,socket:o})),t(),chrome.socket.setMulticastTimeToLive(o,2,function(){chrome.socket.setMulticastLoopbackMode(o,!1,function(){chrome.socket.joinGroup(o,r,function(t){return 0!==t?(e.error("Could not join group. Error code: "+t),i.close(),void 0):void 0})})})})})},i.send=function(u,a,s,c,f){f=f||{},n=c,chrome.socket.create("udp",function(n){o=n.socketId,chrome.socket.bind(o,"0.0.0.0",0,function(){t(),e.debug("Sending to {ip}:{port} on socket id '{socket}'.".assign({ip:a,port:s,socket:o}),u),chrome.socket.sendTo(o,r.toBuffer(u),a,s,function(){})})}),f.timeout&&setTimeout(i.close,1e3*f.timeout)},i}var e=t("log"),r=t("net/base"),i=t("utils/environment"),o=chrome&&chrome.socket?!0:!1;return o&&navigator&&navigator.userAgent&&(i.USER_AGENT=i.USER_AGENT.assign(navigator.userAgent)),{isSupported:o,udpSocket:n}}),e("net/main",["require","log","net/chrome"],function(t){var n=t("log"),e=t("net/chrome");return e.isSupported?(n.info("Networking module found support for chrome sockets."),e):(n.warning("Networking module didn't find any suitable networking support."),{isSupported:!1})}),e("net",["net/main"],function(t){return t}),e("upnp/ssdp",["require","log","utils/environment"],function(t){function n(t){switch(t||""){case f.alive:case f.update:case f.goodbye:case f.search:return!0;default:return!1}}function e(t){return t.add("\r\n"),t.join("\r\n")}function r(t,n){if(0!==(t||"").length){var e=t.words(),r=e.first().toLocaleUpperCase().to(-1),i=e.from(1).join(" ");switch(r){case"HOST":var o=i.split(":");2===o.length?(n.ip=o[0],n.port=o[1].toNumber()):s.error("Bad address format: {1}".assign(i));break;case"CACHE-CONTROL":n.keepAlive=i.words().last().toNumber();break;case"DATE":var u=new Date(i);n.date=u.isValid()?u:null;break;case"LOCATION":n.location=i;break;case"ST":case"NT":n.targetScope=i;break;case"MAN":case"NTS":n.advertisement=i.replace(/"/g,"");break;case"MX":n.maxWaitTime=i.toNumber();break;case"USN":n.uniqueServiceName=i;break;case"USER-AGENT":case"SERVER":n.userAgent=i;break;case"X-RINCON-BOOTSEQ":case"BOOTID.UPNP.ORG":n.bootId=i.toNumber();break;case"NEXTBOOTID.UPNP.ORG":n.nextBootId=i.toNumber();break;case"X-RINCON-HOUSEHOLD":n.householdToken=i;break;case"EXT":break;default:s.debug("Unknown SSDP header '{1}' was ignored.".assign(r))}}}function i(t){if("string"!=typeof t)return t;t=t.trim();var n={},e=t.search(/^\n+$/m);return e>=0&&(t=t.to(e)),t.lines(function(t,e){t=t.trim(),0===e&&t.has("HTTP/1.1")?n.REQUEST_HEADER=t:e>0&&t.length>0&&r(t,n)}),n}function o(t){t=t||{};var n={};return n.targetScope=t.targetScope||"",n.maxWaitTime=t.maxWaitTime||5,n.userAgent=t.userAgent||c.USER_AGENT,n.isValid=function(){return Object.keys(n).all(function(t){return n[t]?!0:!1})},n.toData=function(){return e(["M-SEARCH * HTTP/1.1","HOST: 239.255.255.250:1900",'MAN: "{1}"'.assign(f.search),"MX: "+n.maxWaitTime,"ST: "+n.targetScope,"USER-AGENT: "+n.userAgent])},n}function u(t){t=t||{};var n={};return n.keepAlive=t.keepAlive||1800,n.date=t.date,n.location=t.location||"",n.targetScope=t.targetScope||"",n.userAgent=t.userAgent||"",n.uniqueServiceName=t.uniqueServiceName||"",n.bootId=t.bootId||0,n.searchPort=t.searchPort,n.householdToken=t.householdToken,n.isValid=function(){return Object.keys(n).all(function(t){return"searchPort"===t?!0:n[t]?!0:!1})},n}function a(t){t=t||{};var e={};return e.location=t.location||"",e.targetScope=t.targetScope||"",e.advertisement=t.advertisement||"",e.uniqueServiceName=t.uniqueServiceName||"",e.bootId=t.bootId||1,e.householdToken=t.householdToken,e.advertisement===f.alive?(e.keepAlive=t.keepAlive||1800,e.server=t.server||c.USER_AGENT):e.advertisement===f.update&&(e.nextBootId=t.nextBootId||e.bootId+1),e.searchPort=t.searchPort,e.isNotificationSubType=function(t){return n(t)&&e.advertisement===t},e.isValid=function(){return n(e.advertisement)?Object.keys(e).all(function(t){return"searchPort"===t?!0:e[t]?!0:!1}):!1},e}var s=t("log"),c=t("utils/environment"),f={search:"ssdp:discover",update:"ssdp:update",alive:"ssdp:alive",goodbye:"ssdp:byebye"};return u.fromData=function(t){var n=i(t);if(0!==n.REQUEST_HEADER.search(/HTTP\/1.1\s+200\s+OK/i))return null;var e=u(n);return e.isValid()?e:null},a.fromData=function(t){var n=i(t);if(0!==n.REQUEST_HEADER.search(/NOTIFY\s+\*\s+HTTP\/1.1/i))return null;var e=a(n);return e.isValid()?e:null},{advertisementType:f,discoveryRequest:o,discoveryResponse:u,notification:a}}),e("upnp/control",["require","log"],function(t){function n(t){t=Object.merge({action:"POST"},t);var n={},r=t.payload||"";return n.getPayload=function(){return r},n.setPayload=function(t){return t.toSoap?(r=t,void 0):(e.warning("Payload does not seem to be a SOAP message."),void 0)},n.havePayload=function(){return r&&r.toSoap},n.toString=function(){var t=[parent.toString(),'CONTENT-TYPE: text/xml; charset="utf-8"'];return n.havePayload()&&t.add(n.getPayload().toSoap()),t.join("\r\n")},n}var e=t("log");return{request:n}}),e("upnp/main",["require","upnp/ssdp","upnp/control"],function(t){return{ssdp:t("upnp/ssdp"),control:t("upnp/control")}}),e("upnp",["upnp/main"],function(t){return t}),e("main",["require","sugar","log","utils/environment","net","upnp"],function(t){function n(){function t(t,n){f&&l[t].forEach(function(t){setTimeout(function(){t(n)},0)})}function n(n){t(u.DEVICE_FOUND,n);var r=o.ssdp.discoveryResponse.fromData(n);return r?(e.debug("Got discovery response."),t(u.DEVICE_FOUND,r),void 0):(e.debug("Ignoring response that was not a SSDP discovery response: \n"+n),void 0)}function r(n){var r=o.ssdp.notification.fromData(n);return r?(e.debug("Got a notification message."),r.isNotificationSubType(o.ssdp.advertisementType.goodbye)?(e.debug("Device '{1}' is leaving".assign(r.getId())),t(u.DEVICE_LEAVE,r)):r.isNotificationSubType(o.ssdp.advertisementType.alive)?(e.debug("Device '{1}' says alive".assign(r.getId())),t(u.DEVICE_FOUND,r)):r.isNotificationSubType(o.ssdp.advertisementType.update)&&(e.debug("Device '{1}' should be updated".assign(r.getId())),t(u.DEVICE_UPDATE,r)),void 0):(e.debug("Ignoring response that was not a SSDP notification: \n"+n),void 0)}function a(){e.info("Sending discovery on Sonos UPnP controller");var t=o.ssdp.discoveryRequest({targetScope:"urn:schemas-upnp-org:device:ZonePlayer:1",maxWaitTime:5}),r={timeout:t.maxWaitTime+2};3..times(function(){i.udpSocket().send(t.toData(),"239.255.255.250",1900,n,r)}.lazy(250))}var s,c={},f=!1,l={};return Object.values(u,function(t){l[t]=[]}),c.onEvent=function(t,n){Object.values(u).any(t)&&l[t].add(n)},c.start=function(){e.info("Starting the Sonos UPnP controller"),f=!0,s||(s=i.udpSocket(),s.joinMulticast("239.255.255.250",1900,r),a())},c.stop=function(){e.info("Stopping the Sonos UPnP controller"),f=!1,s&&!s.isClosed()&&s.close()},c}t("sugar");var e=t("log"),r=t("utils/environment"),i=t("net"),o=t("upnp"),u={DEVICE_FOUND:1,DEVICE_UPDATE:2,DEVICE_LEAVE:3};return{VERSION:r.VERSION,events:u,service:n()}}),n(["main"]),n("main")});